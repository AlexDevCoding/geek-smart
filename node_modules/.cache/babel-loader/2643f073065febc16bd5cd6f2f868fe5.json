{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEvent } from 'rc-util';\nimport * as React from 'react';\n\nfunction getPosition(e) {\n  var obj = 'touches' in e ? e.touches[0] : e;\n  return {\n    pageX: obj.pageX,\n    pageY: obj.pageY\n  };\n}\n\nfunction useDrag(containerRef, direction, rawValues, min, max, formatValue, triggerChange, finishChange, offsetValues) {\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      draggingValue = _React$useState2[0],\n      setDraggingValue = _React$useState2[1];\n\n  var _React$useState3 = React.useState(-1),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      draggingIndex = _React$useState4[0],\n      setDraggingIndex = _React$useState4[1];\n\n  var _React$useState5 = React.useState(rawValues),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      cacheValues = _React$useState6[0],\n      setCacheValues = _React$useState6[1];\n\n  var _React$useState7 = React.useState(rawValues),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      originValues = _React$useState8[0],\n      setOriginValues = _React$useState8[1];\n\n  var mouseMoveEventRef = React.useRef(null);\n  var mouseUpEventRef = React.useRef(null);\n  React.useLayoutEffect(function () {\n    if (draggingIndex === -1) {\n      setCacheValues(rawValues);\n    }\n  }, [rawValues, draggingIndex]); // Clean up event\n\n  React.useEffect(function () {\n    return function () {\n      document.removeEventListener('mousemove', mouseMoveEventRef.current);\n      document.removeEventListener('mouseup', mouseUpEventRef.current);\n      document.removeEventListener('touchmove', mouseMoveEventRef.current);\n      document.removeEventListener('touchend', mouseUpEventRef.current);\n    };\n  }, []);\n\n  var flushValues = function flushValues(nextValues, nextValue) {\n    // Perf: Only update state when value changed\n    if (cacheValues.some(function (val, i) {\n      return val !== nextValues[i];\n    })) {\n      if (nextValue !== undefined) {\n        setDraggingValue(nextValue);\n      }\n\n      setCacheValues(nextValues);\n      triggerChange(nextValues);\n    }\n  };\n\n  var updateCacheValue = useEvent(function (valueIndex, offsetPercent) {\n    // Basic point offset\n    if (valueIndex === -1) {\n      // >>>> Dragging on the track\n      var startValue = originValues[0];\n      var endValue = originValues[originValues.length - 1];\n      var maxStartOffset = min - startValue;\n      var maxEndOffset = max - endValue; // Get valid offset\n\n      var offset = offsetPercent * (max - min);\n      offset = Math.max(offset, maxStartOffset);\n      offset = Math.min(offset, maxEndOffset); // Use first value to revert back of valid offset (like steps marks)\n\n      var formatStartValue = formatValue(startValue + offset);\n      offset = formatStartValue - startValue;\n      var cloneCacheValues = originValues.map(function (val) {\n        return val + offset;\n      });\n      flushValues(cloneCacheValues);\n    } else {\n      // >>>> Dragging on the handle\n      var offsetDist = (max - min) * offsetPercent; // Always start with the valueIndex origin value\n\n      var cloneValues = _toConsumableArray(cacheValues);\n\n      cloneValues[valueIndex] = originValues[valueIndex];\n      var next = offsetValues(cloneValues, offsetDist, valueIndex, 'dist');\n      flushValues(next.values, next.value);\n    }\n  });\n\n  var onStartMove = function onStartMove(e, valueIndex, startValues) {\n    e.stopPropagation(); // 如果是点击 track 触发的，需要传入变化后的初始值，而不能直接用 rawValues\n\n    var initialValues = startValues || rawValues;\n    var originValue = initialValues[valueIndex];\n    setDraggingIndex(valueIndex);\n    setDraggingValue(originValue);\n    setOriginValues(initialValues);\n\n    var _getPosition = getPosition(e),\n        startX = _getPosition.pageX,\n        startY = _getPosition.pageY; // Moving\n\n\n    var onMouseMove = function onMouseMove(event) {\n      event.preventDefault();\n\n      var _getPosition2 = getPosition(event),\n          moveX = _getPosition2.pageX,\n          moveY = _getPosition2.pageY;\n\n      var offsetX = moveX - startX;\n      var offsetY = moveY - startY;\n\n      var _containerRef$current = containerRef.current.getBoundingClientRect(),\n          width = _containerRef$current.width,\n          height = _containerRef$current.height;\n\n      var offSetPercent;\n\n      switch (direction) {\n        case 'btt':\n          offSetPercent = -offsetY / height;\n          break;\n\n        case 'ttb':\n          offSetPercent = offsetY / height;\n          break;\n\n        case 'rtl':\n          offSetPercent = -offsetX / width;\n          break;\n\n        default:\n          offSetPercent = offsetX / width;\n      }\n\n      updateCacheValue(valueIndex, offSetPercent);\n    }; // End\n\n\n    var onMouseUp = function onMouseUp(event) {\n      event.preventDefault();\n      document.removeEventListener('mouseup', onMouseUp);\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('touchend', onMouseUp);\n      document.removeEventListener('touchmove', onMouseMove);\n      mouseMoveEventRef.current = null;\n      mouseUpEventRef.current = null;\n      setDraggingIndex(-1);\n      finishChange();\n    };\n\n    document.addEventListener('mouseup', onMouseUp);\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('touchend', onMouseUp);\n    document.addEventListener('touchmove', onMouseMove);\n    mouseMoveEventRef.current = onMouseMove;\n    mouseUpEventRef.current = onMouseUp;\n  }; // Only return cache value when it mapping with rawValues\n\n\n  var returnValues = React.useMemo(function () {\n    var sourceValues = _toConsumableArray(rawValues).sort(function (a, b) {\n      return a - b;\n    });\n\n    var targetValues = _toConsumableArray(cacheValues).sort(function (a, b) {\n      return a - b;\n    });\n\n    return sourceValues.every(function (val, index) {\n      return val === targetValues[index];\n    }) ? cacheValues : rawValues;\n  }, [rawValues, cacheValues]);\n  return [draggingIndex, draggingValue, returnValues, onStartMove];\n}\n\nexport default useDrag;","map":{"version":3,"sources":["C:/Users/david/Documents/geek-smart-ser/node_modules/rc-slider/es/hooks/useDrag.js"],"names":["_toConsumableArray","_slicedToArray","useEvent","React","getPosition","e","obj","touches","pageX","pageY","useDrag","containerRef","direction","rawValues","min","max","formatValue","triggerChange","finishChange","offsetValues","_React$useState","useState","_React$useState2","draggingValue","setDraggingValue","_React$useState3","_React$useState4","draggingIndex","setDraggingIndex","_React$useState5","_React$useState6","cacheValues","setCacheValues","_React$useState7","_React$useState8","originValues","setOriginValues","mouseMoveEventRef","useRef","mouseUpEventRef","useLayoutEffect","useEffect","document","removeEventListener","current","flushValues","nextValues","nextValue","some","val","i","undefined","updateCacheValue","valueIndex","offsetPercent","startValue","endValue","length","maxStartOffset","maxEndOffset","offset","Math","formatStartValue","cloneCacheValues","map","offsetDist","cloneValues","next","values","value","onStartMove","startValues","stopPropagation","initialValues","originValue","_getPosition","startX","startY","onMouseMove","event","preventDefault","_getPosition2","moveX","moveY","offsetX","offsetY","_containerRef$current","getBoundingClientRect","width","height","offSetPercent","onMouseUp","addEventListener","returnValues","useMemo","sourceValues","sort","a","b","targetValues","every","index"],"mappings":"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","sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEvent } from 'rc-util';\nimport * as React from 'react';\nfunction getPosition(e) {\n  var obj = 'touches' in e ? e.touches[0] : e;\n  return {\n    pageX: obj.pageX,\n    pageY: obj.pageY\n  };\n}\nfunction useDrag(containerRef, direction, rawValues, min, max, formatValue, triggerChange, finishChange, offsetValues) {\n  var _React$useState = React.useState(null),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    draggingValue = _React$useState2[0],\n    setDraggingValue = _React$useState2[1];\n  var _React$useState3 = React.useState(-1),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    draggingIndex = _React$useState4[0],\n    setDraggingIndex = _React$useState4[1];\n  var _React$useState5 = React.useState(rawValues),\n    _React$useState6 = _slicedToArray(_React$useState5, 2),\n    cacheValues = _React$useState6[0],\n    setCacheValues = _React$useState6[1];\n  var _React$useState7 = React.useState(rawValues),\n    _React$useState8 = _slicedToArray(_React$useState7, 2),\n    originValues = _React$useState8[0],\n    setOriginValues = _React$useState8[1];\n  var mouseMoveEventRef = React.useRef(null);\n  var mouseUpEventRef = React.useRef(null);\n  React.useLayoutEffect(function () {\n    if (draggingIndex === -1) {\n      setCacheValues(rawValues);\n    }\n  }, [rawValues, draggingIndex]);\n\n  // Clean up event\n  React.useEffect(function () {\n    return function () {\n      document.removeEventListener('mousemove', mouseMoveEventRef.current);\n      document.removeEventListener('mouseup', mouseUpEventRef.current);\n      document.removeEventListener('touchmove', mouseMoveEventRef.current);\n      document.removeEventListener('touchend', mouseUpEventRef.current);\n    };\n  }, []);\n  var flushValues = function flushValues(nextValues, nextValue) {\n    // Perf: Only update state when value changed\n    if (cacheValues.some(function (val, i) {\n      return val !== nextValues[i];\n    })) {\n      if (nextValue !== undefined) {\n        setDraggingValue(nextValue);\n      }\n      setCacheValues(nextValues);\n      triggerChange(nextValues);\n    }\n  };\n  var updateCacheValue = useEvent(function (valueIndex, offsetPercent) {\n    // Basic point offset\n\n    if (valueIndex === -1) {\n      // >>>> Dragging on the track\n      var startValue = originValues[0];\n      var endValue = originValues[originValues.length - 1];\n      var maxStartOffset = min - startValue;\n      var maxEndOffset = max - endValue;\n\n      // Get valid offset\n      var offset = offsetPercent * (max - min);\n      offset = Math.max(offset, maxStartOffset);\n      offset = Math.min(offset, maxEndOffset);\n\n      // Use first value to revert back of valid offset (like steps marks)\n      var formatStartValue = formatValue(startValue + offset);\n      offset = formatStartValue - startValue;\n      var cloneCacheValues = originValues.map(function (val) {\n        return val + offset;\n      });\n      flushValues(cloneCacheValues);\n    } else {\n      // >>>> Dragging on the handle\n      var offsetDist = (max - min) * offsetPercent;\n\n      // Always start with the valueIndex origin value\n      var cloneValues = _toConsumableArray(cacheValues);\n      cloneValues[valueIndex] = originValues[valueIndex];\n      var next = offsetValues(cloneValues, offsetDist, valueIndex, 'dist');\n      flushValues(next.values, next.value);\n    }\n  });\n  var onStartMove = function onStartMove(e, valueIndex, startValues) {\n    e.stopPropagation();\n\n    // 如果是点击 track 触发的，需要传入变化后的初始值，而不能直接用 rawValues\n    var initialValues = startValues || rawValues;\n    var originValue = initialValues[valueIndex];\n    setDraggingIndex(valueIndex);\n    setDraggingValue(originValue);\n    setOriginValues(initialValues);\n    var _getPosition = getPosition(e),\n      startX = _getPosition.pageX,\n      startY = _getPosition.pageY;\n\n    // Moving\n    var onMouseMove = function onMouseMove(event) {\n      event.preventDefault();\n      var _getPosition2 = getPosition(event),\n        moveX = _getPosition2.pageX,\n        moveY = _getPosition2.pageY;\n      var offsetX = moveX - startX;\n      var offsetY = moveY - startY;\n      var _containerRef$current = containerRef.current.getBoundingClientRect(),\n        width = _containerRef$current.width,\n        height = _containerRef$current.height;\n      var offSetPercent;\n      switch (direction) {\n        case 'btt':\n          offSetPercent = -offsetY / height;\n          break;\n        case 'ttb':\n          offSetPercent = offsetY / height;\n          break;\n        case 'rtl':\n          offSetPercent = -offsetX / width;\n          break;\n        default:\n          offSetPercent = offsetX / width;\n      }\n      updateCacheValue(valueIndex, offSetPercent);\n    };\n\n    // End\n    var onMouseUp = function onMouseUp(event) {\n      event.preventDefault();\n      document.removeEventListener('mouseup', onMouseUp);\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('touchend', onMouseUp);\n      document.removeEventListener('touchmove', onMouseMove);\n      mouseMoveEventRef.current = null;\n      mouseUpEventRef.current = null;\n      setDraggingIndex(-1);\n      finishChange();\n    };\n    document.addEventListener('mouseup', onMouseUp);\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('touchend', onMouseUp);\n    document.addEventListener('touchmove', onMouseMove);\n    mouseMoveEventRef.current = onMouseMove;\n    mouseUpEventRef.current = onMouseUp;\n  };\n\n  // Only return cache value when it mapping with rawValues\n  var returnValues = React.useMemo(function () {\n    var sourceValues = _toConsumableArray(rawValues).sort(function (a, b) {\n      return a - b;\n    });\n    var targetValues = _toConsumableArray(cacheValues).sort(function (a, b) {\n      return a - b;\n    });\n    return sourceValues.every(function (val, index) {\n      return val === targetValues[index];\n    }) ? cacheValues : rawValues;\n  }, [rawValues, cacheValues]);\n  return [draggingIndex, draggingValue, returnValues, onStartMove];\n}\nexport default useDrag;"]},"metadata":{},"sourceType":"module"}